# =========================================================
# ‚úÖ RENDER DEPLOY CONFIGURATION (render.yaml)
# =========================================================
services:
  - type: web
    name: xauusd-ai-trader
    env: python
    plan: free
    region: oregon
    autoDeploy: true

    buildCommand: |
      echo "üîß Setting up Python environment..."
      pip install --upgrade pip setuptools wheel
      pip cache purge || true

      echo "üì¶ Installing dependencies..."
      pip install --prefer-binary --no-build-isolation -r requirements.txt

      echo "üóÇÔ∏è Preparing directories..."
      mkdir -p data models logs

      echo "‚úÖ Build complete!"

    startCommand: |
      gunicorn main:app --workers 1 --threads 2 --timeout 300 --bind 0.0.0.0:$PORT

    envVars:
      - key: PYTHON_VERSION
        value: 3.10.13                         # üëà Force Python 3.10.13 (fix pandas compile error)
      - key: PORT
        value: 10000                           # Required for Render web apps
      - key: REFRESH_INTERVAL_SECS
        value: 3600                            # Refresh every hour
      - key: ALPHAV_API_KEY
        sync: false                            # Add securely via Render Dashboard
      - key: RAPID_API_KEY
        sync: false                            # Add securely via Render Dashboard
      - key: SELF_PING_URL
        value: https://xauusd-ai-trader.onrender.com/signal  # Keeps service alive
